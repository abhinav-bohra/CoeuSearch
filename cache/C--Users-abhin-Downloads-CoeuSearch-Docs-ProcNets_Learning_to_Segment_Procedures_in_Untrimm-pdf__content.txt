See discussions , stats , author profiles publication : https : //www.researchgate.net/publication/          ProcNets : Learning Segment Procedures Untrimmed Unconstrained Videos READS     Chenliang Xu University Michigan    PUBLICATIONS  ,    CITATIONS SEE PROFILE Article · March      CITATIONS     authors : Luowei Zhou University Michigan    PUBLICATIONS     CITATIONS SEE PROFILE Jason Corso University Michigan     PUBLICATIONS  ,    CITATIONS SEE PROFILE authors publication also working related projects : Advanced risk models View project Multivariate Gaussian models View project content following page uploaded Luowei Zhou    April      . user requested enhancement downloaded file . ProcNets : Learning Segment Procedures Untrimmed Unconstrained Videos Luowei Zhou University Michigan luozhou @ umich.edu Chenliang Xu University Rochester Chenliang.Xu @ rochester.edu Jason J. Corso University Michigan jjcorso @ umich.edu         r       ] V C .  c [   v           .         : v  X r  Abstract propose temporal segmentation procedure long untrimmed unconstrained learning model videos , e.g. , videos YouTube . proposed model seg- ments video segments constitute procedure learns underlying temporal dependency among pro- cedure segments . output procedure segments applied tasks , video description genera- tion activity recognition . Two aspects distinguish work existing literature . First , introduce problem learning long-range temporal structure pro- cedure segments within video , contrast majority efforts focus understanding short-range tempo- ral structure . Second , proposed model segments un- seen video visual evidence automatically determine number segments predict . evalua- tion , large-scale dataset annotated proce- dure steps available . Hence , collect new cooking video dataset , named YouCookII , procedure steps local- ized described . ProcNets model achieves state-of- the-art performance procedure segmentation .   . Introduction Action understanding remains intensely studied problem-space , e.g. , action recognition [    ,   ,    ,    ] , ac- tion detection [    ,    ,    ] action labeling [    ,    ,    ,   ] . Whether action key video under- standing [   ] , action clearly plays role long , untrimmed videos convey various procedures , preparing coffee [    ] changing tire [   ] . paper , study long untrimmed videos propose new model , Procedure Segment Networks ProcNets ( Figure   ) , automatically learning extract constituent category- independent procedure segments . Procedure learning proposed , video- subtitle alignment [    ,   ] discovery common proce- dure steps speciﬁc process [   ,    ] , , papers Figure   . ProcNets learn segment category-independent tempo- ral procedures long , untrimmed unconstrained videos assumptions contiguous segments , number segments , speciﬁc action classes temporal procedure segments . make restrictive assumptions : typically as- sume either language concurrently available , e.g. , subtitles , number procedure steps certain proce- dure ﬁxed , . assumptions limited : extra textual input unavailable scenarios , ego- centric videos ; subtitles action sequences automati- cally generated machines , e.g. , YouTube ’ ASR system , inaccurate require manually intervention ; many procedures certain type , speciﬁc recipe , vary number procedure steps different instances ( process variation ) . proposed ProcNets make neither assumptions hence versatile . addition explicit procedure learning , second area existing work action segmentation label- ing [    ,    ,    ,   ] —the problem segmenting long video contiguous segments correspond sequence actions . action set typically includes predeﬁned actions Take Bowl Pour Milk [    ,    ] . methods assume contiguous action segments limited background activities segments [    ,    ] . Yet , background activities detrimental existing action segmentation approaches [    ] , various uncon- strained , untrimmed videos spread procedure segments throughout video many gaps . segment-   InstructionalVideoProcedureSegmentProposalSequentialPredictionPredicted SegmentsGround-truthProceduresLSTMLSTMLSTMLSTMLSTMVideo RepresentationCNN < END > P r c N e      Figure   . example YouCookII dataset making BLT sandwich . procedure step time boundaries annotated described English sentence . Video YouTube ID :  eWzsx vAi  . ing action boundaries , Huang et al . [    ] enforce ac- tion alignment frame-wise visual similarities Kuehne et al . [    ] apply Hidden Markov Models ( HMM ) learn likelihood image features given hidden ac- tion states . cases , local temporal structures learned , i.e. , transitions adjacent action states , leaving long-range dependencies captured . exam- ple , video making BLT sandwich , procedure step “ Grill tomatoes put plate ” implies long-range dependency end state , in- volve tomatoes either plate sandwich . address collective limitations , propose Pro- cedure Segmentation Networks ( ProcNets ) learning temporal structure long untrimmed unconstrained videos segmenting video sequence pro- cedure segments . output procedure segments Proc- Nets applied tasks , video descrip- tion generation [    ] activity recognition [    ] . ProcNets three pieces :   ) context-aware feature encoding frames ,   ) procedure localization proposing localized candidate temporal segments , call procedure Seg- ment proposals ,   ) sequential procedure modeling learn- ing temporal structure among proposals Recurrent Neural Network ( RNN ) structure . ProcNets ad- dress issues previously mentioned . First , pro- posed model discovers procedure segments video using visual evidence only—no language data assumed avail- able . , number procedure segments automat- ically determined model . Second , instead pre- dicting inter-action boundaries , proposed model detects candidate procedure segments background activ- ity ; far know , ﬁrst work video use anchor proposal offset regression mechanism [    ] . Third , use RNN structure learn long-term tem- poral structure video based video content candidate proposals . Although method general various situa- tions [    ,   ] , focus instructional videos allow analysis extracted procedure segments given video , expect structured coupled general videos . However , large-scale instruc- tional video dataset temporal procedure steps anno- tated yet available . end , collect new cook- ing video dataset , named YouCookII . YouCookII contains      videos    recipes total length     hours . procedure steps video annotated temporal boundaries described imperative En- glish sentences ( see Fig .   ) . evaluate sequential or- dering procedure segments , apply two newly-deﬁned metrics , Average Recall segments mean IoU . contributions three-fold . First , far know , introduce ﬁrst tackle procedure se- quential prediction long , untrimmed unconstrained videos action-speciﬁc labels available train- ing . Second , propose generic structure procedure segmentation output segments applied tasks involve video segments . Third , collect large-scale dataset understanding procedure segments instructional videos .   . Related Work idea studying procedure segmentation prob- lem inspired multiple research focuses introduce critical work forming viewpoints to- wards problem . Video Segmentation Procedure . Temporal video seg- mentation [    ,    ] focuses segmenting video visually semantically integral segments . Kowdle et al . [    ] deﬁne temporal video segmentation problem detecting shot scene boundaries . Potapov et al . [    ] develop deﬁnition segmenting video semantically-consistent segments detecting shot bound- aries also general semantic change points . , summarize deﬁnition procedure segment se- mantic units fulﬁlling subprocess rather consistent existing literature [    ,   ] . Temporal Action Detection . approaches action de- tection , especially recent ones based action proposal [    ] , inspire us segment video procedure proprosing procedure segment candidates . Early works action de- tection mainly use sliding windows proposing segments [    ,    ] . Disadvantages type method Grill tomatoes pan put plate.Add oil pan spread well fry baconPlace piece lettuce first layer , place tomatoes it.Sprinkle salt pepper taste.Add bit Worcestershire sauce mayonnaise spread bread.Place bacon top.Place piece bread top.Cook bacon crispy , drain paper towel  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :   Start time : End time : Figure   . Schematic illustration Procedure Segmentation Network ( ProcNets ) . input frame-wise ResNet feature ( row ) video . outputs proposed procedure segments . input feature travels though end-to-end network three stages . First , bidirectional LSTM embeds ResNet features context-aware features . , procedure segment proposal module proposes procedure proposals . Finally , sequential prediction module selects ﬁnal proposals LSTM . training , ground-truth segments embedded composite LSTM input , removed testing . inference , beam search applied , shown dashed lines . summarized [    ] . recently , Shou et al . [    ] pro- pose multi-stage convolutional network penalties ac- tion proposals small overlapping ground truth achieves state-of-the-art performance Thumos      [    ] . similar work Deep Action Propos- als ( DAPs ) proposed Escorcia et al [    ] model predicts likelihood action proposals action model predicts procedure segment proposals . An- difference , DAPs model determines location action anchors k-means clustering ground- truth segments training , model learns lo- calize procedures regression addresses case actions distributed differently test video . Action Labeling Procedure Learning . Modeling sequence actions procedure segments leveraging local visual patterns studied recently . Given video sequence actions exist video , ac- tion labeling approaches temporally localize action video weakly supervised manner [   ] . Huang et [    ] propose model forces action vi- al . sual consistence based frame-wise visual similarities . Kuehne et al [    ] apply HMMs align actions video frames . cases , local temporal structures built , i.e. , transitions adjacent action states , long-range temporal structure barely captured . con- trast , method learn long-range temporal structure .   . Procedure Segmentation Networks propose model , named Procedure Segmentation Networks ( ProcNets ) , segmenting long untrimmed unconstrained video sequence procedure segments . testing , given unseen video , ProcNets propose localize candidate procedure segments video based visual appearances temporal relations , without need knowing pre-speciﬁed procedure steps [    ] subtitles video [   ] . proposed ProcNets three stages : context-aware video encoding ( Sec .  .  ) , procedure segment proposal ( Sec .  .  ) , sequential prediction ( Sec .  .  ) . over- network structure shown Fig .   overall loss function deﬁned Sec .  .  .  .  . Context-Aware Video Encoding Without loss generality , represent long untrimmed video x = { x  , x  , . . . , xL } , L de- notes number sampled frames video xi ∈ frame-level CNN feature . , e feature en- coding size . use ResNet [    ,    ] , pretrained Im- ageNet [   ] MSCOCO [    ] , video-frame encoder state-of-the-art performance image classiﬁcation . video representation captures appearance in- formation separate frames . put  ResNet features one-layer bidirectional LSTM LinearLayerResNet Features ( L X     ) Segment Proposals ( k x L x   ) (  . , .  ) Proposed Segments ( start , end ) (  . , .  ) (  . ,  .  ) …SigmoidBi-LSTMLength OffsetCenter OffsetProposal ScoreTanhTanhResNetLSTM-fLSTM-bContext-aware Features ( L X     ) Temporal Conv . Anchors ( K kernel size ) BoundariesScoreMax-poolScoresFlattenLSTMGround-truth SegmentLinearEmbedSegment IndexLikelihood Next SegmentBeamSearchSegment Proposals    …   ClipFeatureProcedureSegment ProposalSequentialPrediction ( Bi-LSTM ) [    ]     hidden units , encode local temporal dependencies . outputs ( forward back- ward ) concatenated ResNet feature frame , followed linear layer reduce feature dimension ResNet feature . dimension reduction allows fair comparison encoding options . call context-aware features , de- noted bi = Bi-LSTM ( x ) , bi ∈ . , context-aware video encoding : b = { b  , b  , . . . , bL } , use input generating procedure segment propos- als . Empirically , Bi-LSTM encoder outperforms context- free feature LSTM-encoded feature relative   % metric AP @  .  , introduced Sec .  .  . Adding motion features optical ﬂow may improve performance .  .  . Procedure Segment Proposal Inspired idea convolutional anchors spatial object proposal , Faster R-CNN [    ] , design set K temporal convolutional anchors procedure segment proposal videos . anchor shape : lk × e ( k =   ,   , .. , K ) , width frame feature size varying lengths cover different time spans ( see Fig .   ) . design temporal convo- lutional anchors together context-aware video en- coding Sec .  .  makes possible compute procedure segment proposals . apply anchors video encoding obtain proposal scores offsets ( center length ) , scores regarded likelihood temporal anchors certain location contain procedure segment offsets used adjust proposed segment boundaries . zero- padding video encoding beginning end ( depends anchor sizes ) , obtain score offsets ma- trices size K × L ( see upper right Fig .   ) total size K × L ×   . formulate proposal scoring classiﬁcation problem proposal offsetting regression problems . Sigmoid function  .  scaled Tanh function applied scoring offsetting , respectively . segment pro- posals classiﬁed procedure segment non-procedure segment cross-entropy loss . training , seg- ment proposals least  .  Intersection-over-Union ( IoU ) ground-truth segments regarded posi- tive samples IoU less  .  ground-truth treated negative samples . randomly pick U samples positive negative respectively training . regress offsets proposal length cen- ter input feature block instead absolute values . proposal center ta length la , regressed center tp length lp w.r.t . offsets ( θt , θl ) deﬁned : (   ) tp = ta + θtla , lp = laeθl . Therefore , boundaries segment proposal de-   ep = tp + lp ﬁned : sp = tp − lp   . train regression model , regress positive samples cor- responding ground-truth procedure segment . Smooth l - loss [    ] applied loss .  .  . Sequential Prediction Contrary spatial objects , video procedure segments , natural , ambiguous temporal boundaries yet strong temporal dependencies . Therefore , must treat differently . use LSTM learn sequential pre- diction procedure segments dynamically determine number procedure segments video . LSTM leverages three representations :   ) Pro- posal Vector : set max-pooled proposal scores Sec .  .  ;   ) Location Embedding Bi : vector embed- ded information location procedure segment ;   ) Segment Content Ci : segment feature vector . tuple three representation ( , Bi , Ci ) =   ,   , ... , n serves input LSTM . intuition LSTM predicts current procedure segments w.r.t . previously predicted segments set proposals whole . softmax output LSTM likelihood proposal next segment prediction . Therefore , likelihood entire procedure segment sequence ( cid:   )   , ... , ( cid:   ) video formulated : log p ( ( cid:   )   , ... , ( cid:   ) S|S , B  , ... , Bn , C  , ... , Cn ) (   ) =  ( cid:   ) t=  log p ( ( cid:   ) t|S , B  , ... , Bn , C  , ... , Cn , ( cid:   )   , ... , ( cid:   ) t−  ) , ( cid:   )   special < start > procedure segment . ob- jective sequential prediction maximize sum sequence likelihood training videos . apply cross-entropy loss likelihood output Pt time step , sample beam search [    ,   ] infer- ence . experiments , simply let beam search equal   yields best result , i.e. , picking index maxi- mal likelihood next proposed segment . algorithm terminates special stop bit picked . Next , de- scribe individual LSTM input representations detail . Proposal Vector . shown bottom part Fig .   , pass proposal score max-pooling layer ﬁlter proposals less likely contain procedure segment . deﬁne kernel size Kh × Kw set stride size overlapping . Experiments size max-pooling layer Sec .  .  . Empirically , setting Kh =   Kw     yields best results . boundaries segment proposals ﬁltered according selected scores max-pooling . proposal score matrix ﬂattened vector columns name Proposal Vector . Location Embedding . training , ground-truth procedure segment represented one-hot vector one entry matches nearest proposal Proposal  .  . Loss Function loss function procedure segmentation net- work consists three parts , cross-entropy loss procedure-ness classiﬁcation , smooth l -loss [    ] offset regression cross-entropy loss sequential prediction . formulations follows : L = Lcla + αrLreg + αsLseq (   ) log (   − ( neg )  ) ) Lcla =   + Un (  ( cid:   ) i=  log ( ( pos )  ) + Un ( cid:   ) i=  Lreg =    ||Bi − B ( gt )  ||smooth−l  Lseq =     ( cid:   ) t=  log ( P    ( gt )  )   ( neg )  Un number positive nega- tive samples , respectively , ( pos ) represents scores , B ( gt ) ground-truth boundary corresponding positive sample , Pt softmax output LSTM time   ( gt ) one-hot vector ground-truth segment index . Discount factors αr αs applied balance con- tributions regression loss sequential prediction loss , respectively . impacts different discount values procedure segmentation discussed Sec .  .  .    . Experiments section , ﬁrst introduce new dataset pro- cedure learning instructional videos ( see Sec .  .  ) . , benchmark dataset state-of-the-art methods video segmentation action detection well pro- posed methods . compare approaches newly- deﬁned metrics focusing evaluating sequential order- ing procedure segments . analyze model functional ( e.g. , ablation studies ) empirical ( e.g. , pa- rameters tuning ) experiments Sec .  .  .  .  . YouCookII Dataset dataset . Existing datasets analyzing instruc- tional videos suffer either limited video resources [   ,    ] weak diversity ( identical background scene [    ] similar activities [    ] ) . Nonetheless , provide limited ground-truth procedure segment boundaries descrip- tions [    ] . statistics properties commonly- used instructional video datasets , namely , YouCook [   ] , MPII [    ] ,   Salads [    ] , Breakfast [    ] Coffee [   ] summarized Tab .   . end , collected cook- ing video dataset , named YouCookII  . Compared   -video YouCook dataset [   ] , dataset contains larger amount videos diverse recipes . YouCookII  More details YouCookII Appendix . dataset public available . source code ProcNets available Github . Figure   . example converting ground-truth segments one-hot vector representations based Proposal Vector . Vector illustrated Fig .   . discrete representation locations easier structure learning continuous location values . trainable embedding matrix , one-hot vector maps vector , call Location Embedding vector depicts location information segment . Location Embedding vector size Proposal Vector . testing , sample previous softmax output LSTM one-hot vector rep- resentation next segment beam search . Segment Content Feature . encode procedure segment content , mean-pool video ResNet feature according segment boundaries . dimension segment content feature reduced match Proposal Vector fully-connected layer refer feature segment feature . Intuitively , procedure segment con- tent infer temporal structure . Recall example making BLT sandwich , procedure segment Grill tomatoes put plate implies long-range depen- dency end state , involve tomatoes either plate sandwich . Relations Models . best knowl- edge , ﬁrst apply sequential modeling extract general video procedure segments . proposed sequential prediction model builds video temporal structure with- need knowing hidden states HMM . Note design choices . Non-Maximal Suppression ( NMS ) . terms proposal selection , commonly adopted method object detec- tion [    ] action detection [    ] NMS . approach fails capture temporal structure instructional videos procedure sequence dependencies , usually requires total segment number oracle . Also , compare Sec .  .  . Time Sequence Models . methods propos- ing segments rigid model conﬁgurations , HMM pre-deﬁned “ grammar ” whole video , infeasible general video structure inference .  .   .   .   .   .   .   .   .  Proposal VectorScoreBoundary (  .  ,  .  ) (  .  ,  .  ) (  .  ,  .  ) (  .  ,  .  ) (  .  ,  .  ) (   .  ,   .  ) (   .  ,   .  ) (   .  ,   .  )                                 One-hot vector representationGround-truth segments (  .  ,  .  ) (  .  ,  .  ) (   .  ,   .  ) (   .  ,   .  ) Table   . Comparisons instructional video datasets . UnCons . stands Unconstrained Scene , Act . Ann . means action annota- tion Proc . Ann . short Procedure Annotation . Name YouCook MPII   Salads Coffee Breakfast Duration UnCons . Act . Ann . Yes   Yes Yes                    h  Yes Yes Yes Yes Proc . Ann .      contains      YouTube videos    recipes ( around    videos ) different regions around world recipe steps video extracted described English sentences well-trained annotators . recipe contains      steps , step described sentence imperative form , grill tomatoes pan . example Fig .   Sec .   . total video time     hours average length  .   mins video . length procedure segments whole dataset distributed Fig .    mean   .  sec- onds standard deviation   .  seconds . Noting paper , use procedure segment annota- tions . make recipe descriptions available future research YouCookII . Preprocessing . Since proposed model needs ac- cess overall information long untrimmed videos , uniformly down-sample     frames video YouCookII . average sample rate  .   fps . fur- ther enlarge training samples , temporally augment data , i.e. , sample video    times temporal shifts . , extract ResNet-   [    ] feature frame . video represented sequence image spatial features , already captures long-ranging temporal changes instructional videos . Notice , local motion features used study , may im- prove performance , leave future work .  .  . Experimental Setup Baselines . introduce baseline methods procedure segmentation . Since ﬁrst tackle procedure sequential prediction problem instructional videos , direct baselines exist . adapt state-of-the-art methods relevant ﬁelds , temporal segmentation , video summarization activity detection , prob- lem . selected methods include :   ) Kernel Temporal Segmentation ( KTS ) [    ] ,   ) Video Summarization LSTM ( vsLSTM ) [    ] ,   ) Segment CNN ( S-CNN ) [    ] . KTS , compute temporal segmentation procedure video image features . Notice method fully unsu- pervised exposure annotated segments . vsLSTM originally used summarizing video keyframes key clips . scenario , apply model proposing procedure segments , trained Figure   . Clip length distribution YouCookII dataset . identical way producing key clips . original S-CNN three-stages , namely , action proposing , action classiﬁcation action localization . remove classi- ﬁcation networks given procedure labels exist setting . Also , disable feature ﬁne-tuning C D fair comparison models . Besides , uniform seg- ment baseline ( Uniform ) clip number optimized also evaluated . Finally , note compare action la- beling segmentation methods since approaches di- rectly model ﬁnite action states ( e.g. , HMM ) requires “ grammer ” whole video process . Metrics . focus evaluate sequen- tial ordering procedure segments . Existing metrics action segmentation action detection fail measure or- dering information among individual segments . Hence , propose two new metrics evaluating procedure segmen- tation : Average Recall  .  ( AR @  .  ) mean IoU ( mIoU ) . AR @  .  , compare proposed segments chronological order ground-truth segments : overlapping greater  .  , proposal correct , otherwise incorrect . mIOU mean IoU pro- posed segments corresponding ground-truth segments averaged validation videos . reason use IoU instead Jaccard meansure [   ] pe- nalize misalignment segments order evalute segment regression performance . worth noting problem , AR metric really strict sense model needs accurately match segments order . example , Fig .   , almost ground-truth segments corresponding proposed segments , , owing second false positive segment , recall becomes zero . De- spite accurate localization performance method , results AR metric fully reﬂect proposal ac- curacy . end , also report results relaxed procedure matching proposed procedure segment r steps away ground-truth , similar relaxation boundary Bosselut et al . [   ] . case , r =   r =   . Training Details . randomly split training , vali- dation testing data ratio    % :   % :   % videos belonging recipe . sizes temporal con-                Clip Length ( second )                          CountDistribution Clip Length Table   . Results temporal segmentation . uniform model optimized generating   segments . KTS ProcNets-NMS output   segments per video . report AR @  .  mIoU values highlight top-  scores . r =   r =   validation test validation test Method ( % ) Uniform KTS [    ] vsLSTM [    ] S-CNN [    ] ProcNets-NMS ( ) ProcNets-LSTM ( ) AR @  .  mIoU AR @  .  mIoU AR @  .  mIoU AR @  .  mIoU   .    .   .   .    .    .    .    .    .    .    .    .    .    .    .    .    .    .    .    .    .   .    .    .    .    .    .    .    .    .   .   .   .   .   .    .    .    .    .    .    .    .   .   .   .   .   .    .  Figure   . negative example ( ID : Y fvfbZGad  ) procedure segmentation . color order consistent chronological order . Recall=  owing second false positive segment . volutional kernel       interval   , approximated make    % segments training set drop range . Hence ,    anchors proposed segment center . procedure classiﬁca- tion , pick U =     samples positive negative respectively feed negative samples positive ones less U .Our implementation based Torch   refers Neuraltalk  [    ] . hyper-parameters , set weight decay rate procedure segmentation network   −  avoid overﬁtting . learning rate language model set   ×   −  . use Adam optimizer [    ] updating weights α =  .  β =  .    . training process temporal segmentation model takes six days single NVIDIA TITAN X GPU . Note able train ProcNets end-to-end raw video segment output . However , practice , disable CNN ﬁne-tuning heavily slows training process .  .  . Procedure Segmentation report procedure segmentation results validation testing sets Tab .   . ﬁrst three methods share property proposing contiguous segments . S-CNN detects segments among background activity . proposed ProcNets-LSTM model outperforms methods huge margin metrics . perfor- mances S-CNN suffers segmentation task possi- bly result lack sequential modeling mechanism . Note optimized Uniform method relative strong baseline since instruction videos , generally procedures span whole video . experiments , performs better supervised methods , vsLSTM , S- CNN ProcNets-NMS scenarios . Uniform method achieves even higher scores testing , imply- ing test videos procedures evenly distributed . rest experiments , except model selection Table   . Ablation study . remove one Proposal Vector ( denoted -Proposal Vec ) , Location Embedding ( denoted - Location Emb ) Segment Content feature ( denoted -Segment Feat ) LSTM input . Full model -Proposal Vec -Linear Emb -Segment Feat AR @  .  mIoU   .    .    .    .    .   .   .   .  validation set , results testing data . Ablation study sequential prediction . input sequence modeling LSTM consists three parts : Proposal Vector , Location Embedding Segment Con- tent vector . remove ablation study . Results shown Tab .   . Unsurprisingly , proposal scores ( Proposal Vector ) play signiﬁcant role in- ferring temporal structure . information un- available , overall performance drops    % relatively . Location Embedding implicitly encodes location information segments helps model mem- orize segments distributed video . video content represented segment feature less contribu- tion sequence prediction , implies video in- formation contained feature representation noisy . Model selection . study impact different pa- rameter combinations model performance . Two groups experiments conducted regarding :   ) max pooling kernel size ,   ) loss discount factors . model selection results validation set reach ﬁ- nal model parameters test uses . max-pooling kernel size , adopt seven combinations ( see Tab .   ) . turns cases , Kh =   Kw     , yield decent results . implies moderate number pro- posal scores , say     , beneﬁts segmentation . differ- ent combinations discount factors combined loss function , show results Tab .   . case three loss terms equal weights , leads combina- tions huge relative gap (    % -   % AR @  .  ) . Proposal localization accuracy . report proposal accuracy segment detection terms recall , preci- sion F  score ( see Tab .   ) . S-CNN shows better seg- Ground-truth : Proposed : Figure   . Examples procedure segmentation . YouTube IDs : BlTCkNkfmRY , jD o Lmy bU jrwHN   H I . Table   . Experiments max pooling kernel size . Kh kernel height Kw kernel width . αr =  .  , αs =  .  AR @  .  mIoU   .    .    .    .    .    .    .  Kh =    , Kw =   Kh =   , Kw =   Kh =   , Kw =   Kh =   , Kw =   Kh =   , Kw =   Kh =   , Kw =   Kh =   , Kw =     .   .   .   .    .    .   .  Table   . Experiments discount factors . αr clip regres- sion loss αs sequence prediction loss . max pooling kernel size   ×   . αr =   , αs =  .  αr =  .  , αs =  .  αr =   , αs =  .  αr =   , αs =   AR @  .  mIoU   .    .    .    .   .    .   .    .  Table   . Results segment detection accuracy . ProcNets output    segments highest procedureness scores NMS . ground- Recall , precision F  score computed w.r.t . truth segments . Top two scores highlighted . Precision   .    .    .    .    .  Method ( % ) Uniform KTS [    ] vsLSTM [    ] S-CNN [    ] ProcNets ( ) Recall   .    .    .    .    .  F    .    .    .    .    .  ment detection capability optimized Uniform , KTS vsLSTM models metrics . proposed model least   % higher recall   % higher preci- sion baslines . Analysis temporal structure learning . conduct experiments demonstrate ProcNets ’ temporal structure learning capability . given testing video , denote ﬁrst half Va second half Vb . inverse order VaVb VbVa construct permu- tated video . evaluate model original test set permutated test set . performance pre-trained Figure   . example output ProcNets original permuted video . YouTube ID : ejq ZsHgwFk . ProcNets decreases half permutated set    % -   % videos segments predicted begining Vb ( see Fig .   ) . explain , two hypotheses . First , model captures ending content Vb terminates segment generation within Vb . Second , temporal structure Va dependencies Vb hence ignored model . Qualitative results . demonstrate qualitative results YouCookII test set ( see Fig .   ) . procedure segments , model accurately localize segments predict lengths . Moreover , number segments proposed varies model learns propose seg- ments begining end video . ex- ample making Grilled Cheese , ProcNets propose ﬁfth segment cover process cutting bread slices two pieces . trivial segment annotated still se- mantically meaningful .   . Conclusion present approach video procedure learning segmentation , named ProcNets . ProcNets take frame-wise video feature input predicts procedure segments exist video . output procedure segments applied tasks , video description generation activity recognition . evaluate model baselines newly collected large-scale cooking video dataset proposed method outperforms baselines huge margin . also demonstrate experiments ProcNets capable inferring video structure video content modeling temporal dependencies among procedure segments . Ground-truth : Proposed : Grilled CheeseGround-truth : Proposed : Ground-truth : Proposed : ChapatiCalamariPancakeGround-truth : Original : Permuted : VaVb Acknowledgement . work supported part Google , ARO W   NF-  - -     NSF NRI         . article solely reﬂects opinions con- clusions authors Google , ARO NSF . sincerely thank colleagues Vikas Dhiman , Madan Ravi Ganesh Ryan Szetor helpful discussions . also thank Mingyang Zhou , Yichen Yao , Haonan Chen Dali Zhang efforts constructing dataset . References [   ] S. Abu-El-Haija , N. Kothari , J. Lee , P. Natsev , G. Toderici , Youtube- m : arXiv preprint B. Varadarajan , S. Vijayanarasimhan . large-scale video classiﬁcation benchmark . arXiv:    .      ,      .   [   ] J.-B . Alayrac , P. Bojanowski , N. Agrawal , I. Laptev , J. Sivic , S. Lacoste-Julien . Unsupervised learning narrated instruction videos . Proceedings IEEE Conference Computer Vision Pattern Recognition ,      .   ,   ,   ,   ,    [   ] P. Bojanowski , R. Lajugie , F. Bach , I. Laptev , J. Ponce , C. Schmid , J. Sivic . Weakly supervised action labeling videos or- European Conference Computer Vision , dering constraints . pages    –    . Springer ,      .   ,   ,   [   ] P. Bojanowski , R. Lajugie , E. Grave , F. Bach , I. Laptev , J. Ponce , C. Schmid . Weakly-supervised alignment video text . Proceedings IEEE International Conference Computer Vision , pages     –     ,      .   [   ] A. Bosselut , J. Chen , D. Warren , H. Hajishirzi , Y. Choi . Learn- ing prototypical event structure photo albums . Proceedings   th Annual Meeting Association Computational Linguistics ,      .   [   ] W. Chen , C. Xiong , R. Xu , J. J. Corso . Actionness ranking IEEE Conference lattice conditional ordinal random ﬁelds . Computer Vision Pattern Recognition ,      .   [   ] P. Das , C. Xu , R. F. Doell , J. J. Corso . thousand frames words : Lingual description videos latent topics sparse object stitching . Proceedings IEEE Conference Computer Vision Pattern Recognition , pages     –     ,      .   ,    [   ] J. Deng , W. Dong , R. Socher , L.-J . Li , K. Li , L. Fei-Fei . Ima- genet : large-scale hierarchical image database . IEEE Confer- ence Computer Vision Pattern Recognition , pages    –    . IEEE ,      .   [   ] J. Donahue , L. Anne Hendricks , S. Guadarrama , M. Rohrbach , S. Venugopalan , K. Saenko , T. Darrell . Long-term recurrent con- volutional networks visual recognition description . Pro- ceedings IEEE Conference Computer Vision Pattern Recognition , pages     –     ,      .   ,   [    ] V. Escorcia , F. C. Heilbron , J. C. Niebles , B. Ghanem . Daps : Deep action proposals action understanding . European Con- ference Computer Vision , pages    –    . Springer ,      .   ,   [    ] Facebook . Torch implementation resnet . https : //github . com/facebook/fb.resnet.torch ,      .   ,    [    ] C. Feichtenhofer , A. Pinz , A. Zisserman . Convolutional two- stream network fusion video action recognition . Proceedings IEEE Conference Computer Vision Pattern Recogni- tion , pages     –     ,      .   [    ] A. Gaidon , Z. Harchaoui , C. Schmid . Temporal localization actions actoms . IEEE transactions pattern analysis ma- chine intelligence ,    (    ) :    –     ,      .   [    ] A. Graves J. Schmidhuber . Framewise phoneme classiﬁcation bidirectional lstm neural network architectures . Neu- ral Networks ,    (   ) :   –    ,      .   [    ] K. , X. Zhang , S. Ren , J . Sun . Deep residual learning image recognition . arXiv preprint arXiv:    .      ,      .   ,   [    ] D.-A . Huang , L. Fei-Fei , J. C. Niebles . Connectionist temporal modeling weakly supervised action labeling . European Con- ference Computer Vision , pages    –    . Springer ,      .   ,   ,   [    ] Y.-G. Jiang , J. Liu , A. Roshan Zamir , G. Toderici , I. Laptev , M. Shah , R. Sukthankar . THUMOS challenge : Action recognition large number classes . http : //crcv.ucf.edu/THUMOS  / ,      .   [    ] A. Karpathy . Neuraltalk  . https : //github.com/karpathy/ neuraltalk  ,      .   [    ] D. Kingma J. Ba . Adam : method stochastic optimization . arXiv preprint arXiv:    .     ,      .   [    ] I. Koprinska S. Carrato . Temporal video segmentation : survey . Signal processing : Image communication ,    (   ) :   –    ,      .   [    ] A. Kowdle T. Chen . Learning segment video clips based scene camera motion . European Conference Computer Vision , pages    –    . Springer ,      .   [    ] H. Kuehne , A. Arslan , T. Serre . language actions : Recov- ering syntax semantics goal-directed human activities . Proceedings IEEE Conference Computer Vision Pattern Recognition , pages    –    ,      .   ,   [    ] H. Kuehne , J. Gall , T. Serre . end-to-end generative frame- work video segmentation recognition .      IEEE Winter Conference Applications Computer Vision ( WACV ) , pages  –  . IEEE ,      .   ,   [    ] H. Kuehne , A. Richard , J. Gall . Weakly supervised learning actions transcripts . arXiv preprint arXiv:    .      ,      .   ,   ,   [    ] T.-Y . Lin , M. Maire , S. Belongie , J. Hays , P. Perona , D. Ramanan , P. Doll´ar , C. L. Zitnick . Microsoft coco : Common objects context . European Conference Computer Vision , pages    –     . Springer ,      .   [    ] J. Malmaud , J. Huang , V. Rathod , N. Johnston , A. Rabinovich , K. Murphy . ’ cookin ’ ? interpreting cooking videos using text , speech vision . arXiv preprint arXiv:    .      ,      .   [    ] D. Oneata , J. Verbeek , C. Schmid . Action event recognition ﬁsher vectors compact feature set . Proceedings IEEE International Conference Computer Vision , pages     –      ,      .   [    ] D. Potapov , M. Douze , Z. Harchaoui , C. Schmid . Category- speciﬁc video summarization . European conference computer vision , pages    –    . Springer ,      .   ,   ,   ,   [    ] M. Regneri , M. Rohrbach , D. Wetzel , S. Thater , B. Schiele , M. Pinkal . Grounding action descriptions videos . Transactions Association Computational Linguistics ,  :  –   ,      .   [    ] S. Ren , K. , R. Girshick , J . Sun . Faster r-cnn : Towards real- time object detection region proposal networks . Advances neural information processing systems , pages   –   ,      .   ,   ,   [    ] A. Rohrbach , M. Rohrbach , W. Qiu , A. Friedrich , M. Pinkal , B. Schiele . Coherent multi-sentence video description variable level detail . German Conference Pattern Recognition , pages    –    . Springer ,      .   [    ] M. Rohrbach , S. Amin , M. Andriluka , B. Schiele . database ﬁne grained activity detection cooking activities . IEEE Con- ference Computer Vision Pattern Recognition , pages     –      . IEEE ,      .   [    ] O. Sener , A. R. Zamir , S. Savarese , A. Saxena . Unsupervised semantic parsing video collections . Proceedings IEEE International Conference Computer Vision , pages     –     ,      .   ,   ,   [    ] Z. Shou , D. Wang , S.-F. Chang . Temporal action localiza- Proceedings tion untrimmed videos via multi-stage cnns . IEEE Conference Computer Vision Pattern Recognition , pages     –     ,      .   ,   ,   ,   ,   ,   [    ] G. A. Sigurdsson , G. Varol , X. Wang , A. Farhadi , I. Laptev , A. Gupta . Hollywood homes : Crowdsourcing data collection activity understanding . European Conference Computer Vision ,      .   ,   [    ] K. Simonyan A. Zisserman . Two-stream convolutional networks action recognition videos . Advances neural information processing systems , pages    –    ,      .   [    ] K. Simonyan A. Zisserman . Vgg   pre-trained mod- http : //www.robots.ox.ac.uk/˜vgg/research/ els . very_deep/ ,      .    [    ] B. Singh , T. K. Marks , M. Jones , O. Tuzel , M. Shao . multi- stream bi-directional recurrent neural network ﬁne-grained action detection . Proceedings IEEE Conference Computer Vi- sion Pattern Recognition , pages     –     ,      .   [    ] S. Stein S. J. McKenna . Combining embedded accelerometers computer vision recognizing food preparation activities . Proceedings      ACM international joint conference Per- vasive ubiquitous computing , pages    –    . ACM ,      .   [    ] O. Vinyals , A. Toshev , S. Bengio , D. Erhan . Show tell : Proceedings IEEE Con- neural image caption generator . ference Computer Vision Pattern Recognition , pages     –      ,      .   ,    [    ] L. Wang , Y. Xiong , Z. Wang , Y. Qiao , D. Lin , X. Tang , L. Van Gool . Temporal segment networks : towards good practices deep action recognition . European Conference Computer Vision , pages   –   . Springer ,      .   [    ] S. Yeung , O. Russakovsky , G. Mori , L. Fei-Fei . End-to-end learning action detection frame glimpses videos . Pro- ceedings IEEE Conference Computer Vision Pattern Recognition , pages     –     ,      .   [    ] H. Yu , J. Wang , Z. Huang , Y. Yang , W. Xu . Video paragraph cap- tioning using hierarchical recurrent neural networks . Proceedings IEEE Conference Computer Vision Pattern Recogni- tion , pages     –     ,      .   [    ] K. Zhang , W.-L. Chao , F. Sha , K. Grauman . Video summariza- tion long short-term memory . arXiv preprint arXiv:    .      ,      .   ,   ,   [    ] L. Zhou , C. Xu , P. Koch , J. J. Corso . eration text-conditional semantic attention . arXiv:    .      ,      .    Image caption gen- arXiv preprint   . Appendix  .  . Results Datasets Data acquisition . allow workers collect video data web interface . interface record various information given video , listed follows . demonstrate procedure segmentations results long , untrimmed unconstrained videos . ProcNets model remains , i.e. , trained YouCookII training set . apply segment procedures unseen videos two commonly used cooking video datasets , YouCook [   ] Coffee [   ] . YouCook , randomly pick   videos    test videos YouCook compare ProcNets top two baselines experiments YouCookII , i.e. , KTS Optimized Uniform . results shown Fig .    . ProcNets generalize well unseen videos belonged un- known recipe categories . ﬁrst last segments generated ProcNets closer actual starting time ending time cooking process gener- ated baselines ( see ﬁrst three examples ) . Video   , ProcNets accurately predicts orange green segments . video   , ground-truth segments rather uniformly distributed favor uniform base- line . ProcNets generate comparable beginning segments . Video   Video   model fail , total segments video   lower usual cases . videos Coffee dataset , procedure segments sparse video content barely observed YouCookII training set . Despite , ProcNets still gen- erate reasonable segments ( see Fig .   ) . instance , ﬁrst segment Video   captures ﬁrst procedure step , predicted segments Video   large overlap- pings ground truth . Also , number segments generated video   exactly annotation video   one segment away .  .  . YouCookII Dataset important features distinguish YouCookII existing datasets instructional videos : • Large-scale cooking dataset      an- notated videos . • Unconstrained videos , preformed individual persons houses unﬁxed cameras . • Long untrimmed videos ,    minutes . • Extremely rich recipe types various cooking styles world . • Procedure steps temporally localized described English sentences . • Video URL . • Number cooks . • Sound options , include English Speech , Native Lan- guage Speech , English Speech Background Music , Native Language Speech Background Music . • Time length estimation . • Time interval cooking process . Start time end time . • Cooking style . Choose one    types . Broil- ing/Baking , Steaming , Grilling , Roasting , Stew- ing , Frying , Raw/Cold-prep , Slow Cooking , Boiling , Kneading Deep-frying . • Recipe type .     recipes total .    used construct YouCookII . Recipe types speciﬁed keywords retrieve videos YouTube . recipe type , collect    videos . video within    mins recorded camera devices slideshows . videos third-person viewpoint made various kitchen environments . videos collected high resolutions recently uploaded . YouCookII consists    recipes four major cui- sine locales , i.e. , America , European/Middle East , East Asia South Asia . full recipe list shown Fig .    . removing videos longer available online , collect total      unique YouTube videos    videos per recipe average . randomly split videos belonging recipe    % :   % :   % training , validation testing sets . Annotations . acquire structured recipe descriptions video . Recipe steps temporally annotated starting time ending time . step described human annotator English sentence . recipe contains      steps , step described sentence imperative form , grill tomatoes pan . annotators access audio/subtitle required organize summarize recipe descriptions ways . Also , annotators biased section , describe details YouCookII dataset four aspects :   ) Data acquisition ,   ) Annotations ,   ) Dataset statistics ,   ) Precomputed Feature . Figure   . Procedure segmentation results Coffee dataset pre-trained ProcNets model . GT stands ground-truth . GTOursGTOursGTOursID :   ID :   ID :    Figure    . Procedure segmentation results YouCook dataset . Video ID :   GTUniformKTSProcNetsVideo ID :   GTUniformKTSProcNetsVideo ID :   GTUniformKTSProcNetsVideo ID :   GTUniformKTSProcNetsVideo ID :   GTUniformKTSProcNetsVideo ID :   GTUniformKTSProcNetsVideo ID :   GTUniformKTSProcNetsVideo ID :   GTUniformKTSProcNets Figure    . Cooking video acquisition status recipe type . goal recipe acquire    unique videos . recipes , existing video tutorials rare . end picking    recipes closest goal construct YouCookII dataset . Figure    . Top     words YouCookII recipe descriptions . Image generated TagCrowd . Table   . example annotated recipes . ID :  eWzsx vAi  . Step ID Starting Time Ending Time                   :  :     :  :     :  :     :  :     :  :     :  :     :  :     :  :     :  :     :  :     :  :     :  :     :  :     :  :     :  :     :  :   Description Grill tomatoes pan put plate Add oil pan spread well fry bacon Cook bacon crispy , drain paper towel Add bit Worcestershire sauce mayonnaise spread bread Place piece lettuce ﬁrst layer , place tomatoes Sprinkle salt pepper taste Place bacon top Place piece bread top user-uploaded recipe descriptions , mostly casual forms . full requirement YouCookII annotation task shown . • clip ( recipe step ) less two minutes long . • recipe includes      steps ; step described one sentence . Ordering among steps counts . • Generally , sentence description      words , use proper grammar punctuation , imperative form . • starting time ending time step recorded form HH : MM : SS . • videos , user-uploaded recipe present text box . annotation task , recipes discarded read used . use video/audio/subtitle generate recipe descrip- tion . example annotation shown Tab .   . Due complexity ﬁne-grained recipe annotation , hire well-trained native English speakers annotators instead crowdsourcing . Also , segment annotations rather subjective . eliminate annotation bias , involve many annotators . far , ﬁne-grained recognition raw video stream rather challenging , especially ingredients utensils cooking videos . might annotate dataset spatiotemporally segmenting cooking tools , in- gredients , related objects actions future update YouCookII . Dataset Statistics . total video time     hours average length  .   mins video . distri- bution number clips per video shown Fig .    .  -  clips per video rather common dataset . length procedure segments whole dataset distributed Fig .    mean   .  seconds standard devi- ation   .  seconds . recipe descriptions , total vocabulary around      top     frequent words Figure    . Distribution number clips per video . Figure    . Clip length distribution YouCookII dataset . shown Fig .    . statistics include :   ) major- ity recipes operated single person ,   )    % video sound English speech rest native language . Precomputed Feature . uniformly down-sample     frames video YouCookII . average sample rate  .   fps . enlarge training samples , temporally augment data , i.e. , sample video    times temporal shifts . crop video frames size     *     . YouCookII , provide multiple options video frame representation , namely , VGG-   feature [    ] , ResNet-   feature [    ] ResNet-    fea- ture [    ] . Note provide two versions ResNet fea- tures extracted two pre-trained models .             Clip Number                     CountDistribution Clip Number per Video            Clip Length ( second )                          CountDistribution Clip Length ﬁrst one trained ImageNet dataset image Classi- ﬁcation task . second one ﬁne-tuned version ﬁrst model image captioning tasks [    ,    ] . video feature computed based second model contains richer semantic information yields better procedure segmenta- tion performance experiment . Motion features , optical ﬂow dense trajectory , might provided future . View publication stats View publication stats 