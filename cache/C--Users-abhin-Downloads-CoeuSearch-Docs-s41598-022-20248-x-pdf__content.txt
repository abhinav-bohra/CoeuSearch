OPEN Inequality constraint  on the maximum genus for 3D  structural compliance topology  optimization Haitao Han1,2, Chong Wang1, Tongxing Zuo1,2 & Zhenyu Liu1,2* Structural topology constraints in topology optimization are an important research topic. The  structural topology is characterized by the topological invariance of the number of holes. The holes  of a structure in 3D space can be classified as internally enclosed holes and external through-holes (or  tunnels). The genus is the number of tunnels. This article proposes the quotient set design variable  method (QSDV) to implement the inequality constraint on the maximum genus allowed in an  optimized structure for 3D structural topology optimization. The principle of the QSDV is to classify  the changing design variables according to the connectivity of the elements in a structure to obtain  the quotient set and update the corresponding elements in the quotient set to meet the topological  constraint. Based on the standard relaxation algorithm discrete variable topology optimization  method (DVTOCRA), the effectiveness of the QSDV is illustrated in numerical examples of a 3D  cantilever beam. Recently, based on the description of the size, shape and number of holes of an optimized structure1, topology  optimization has been implemented from a geometric complexity perspective in a given design domain. The  number of holes in the structure is implicitly designed, and the set of elements in the holes is constrained2–4. In  the 3D case, the number of holes is a topological invariant that is classified as the number of internal enclosed  holes (or enclosed voids) and the genus (or the number of tunnels of a structure). In the study of the numerical  instability of topology optimization, Sigmund et al.5 noted that there are infinite numbers of holes in the global  optimal result. Therefore, structural complexity control is challenging and necessitates substantial theoretical  research for structural topology optimization. The structural complexity control of topology optimization can  be interpreted topologically to constrain the number of enclosed voids and the genus of a structure. Methods of controlling the number of holes of a structure can currently be divided into fuzzy and precise  methods. A fuzzy method is defined as one that satisfies the following two conditions: (a) neither the genus  nor the number of enclosed voids in the optimized structure is considered; (b) the genus and the number of  enclosed voids are handled simultaneously in the optimized structure. For example, a fuzzy method controls the  number of holes without measuring the topological invariance of a structure, such as in the filter method6–9, size  control method10–15, moving morphable components (MMC) method16, and intelligent cavity creation (ICC)   method17. A precise method is defined as one that satisfies the following two conditions: (a) the genus or the  number of enclosed voids in the optimized structure can be calculated directly; (b) the genus or the number of  enclosed voids in the optimized structure can be controlled. Precise methods can be subdivided as follows: (a)  an inequality constrains the number of enclosed voids; (b) an equality constrains the number of enclosed voids,  such as in the application of graph theory and set theory to control the number and sizes of the enclosed voids  of topologically optimized structures2, the virtual temperature approach18,19used to eliminate enclosed voids  and fulfil the connectivity requirement, and the method of imposing an equality constraint on the number of  enclosed voids with discrete sensitivity20; (c) an inequality constrains the genus3,21 ; (d) an equality constrains  the genus; and (e) inequality or equality constraints exist for both the genus and the number of enclosed voids  in the optimized structure. For the aforementioned five cases of precise methods, the research focused on the  last three cases is limited. 1Changchun  Institute of Optics, Fine Mechanics and Physics (CIOMP), Chinese Academy of Sciences,  Changchun 130033, China. 2School of Optoelectronics, University of Chinese Academy of Sciences, Beijing 100049,  China. *email: liuzy@ciomp.ac.cn Scientific Reports | (2022) 12:16185  | https://doi.org/10.1038/s41598-022-20248-x 1 Vol.:(0123456789)www.nature.com/scientificreportsFigure 1. The genus corresponds to the number of handle and tunnel rings. The hole-filling method (HFM) constrains the maximum genus in an optimized structure in 2D space. It can  be extended to constrain the maximum number of enclosed voids in 3D structure topology optimization. The  genus calculation formula for the HFM is derived from the discretized Gauss-Bonnet formula22 for calculating  the genus of a closed, orientable digital surface23 in a 3D grid space. However, when the method is expanded to  3D topology optimization, the following two difficulties are encountered: (a) The outer surface of a 3D structure  should be an orientable and closed surface, and tunnels in a 3D structure may cross each other. Therefore, the  division standard of a tunnel is difficult to determine. In the process of filling one tunnel in a solid structure, the  other tunnel may be filled as well. (b) The discrete Gauss-Bonnet formula requires that the vertices on the outer  surface of the structure be manifold points. However, a solid structure has an arbitrarily connected type in 3D  structural topology optimization. To satisfy the maximum genus constraint on 3D structure topology optimiza- tion, one article proposed the QSDV method based on DVTOCRA 24. There are two main types of methods for calculating the genus of compact, connected, orientable, and  closed surfaces: (a) direct methods such as the Gauss-Bonnet formula25–27 and the Euler-Poincaré characteristic   number28,29; (b) indirect methods such as the Betti number of the surface30–32, the fundamental group33, and the  first homology group of the surface34,35. The latter finds the bases of a tunnel. As shown in Fig. 1, a tunnel can be  represented on a handle ring and a tunnel ring. The Euler-Poincaré characteristic number that is used for calculating the genus of a 2D closed surface can be  extended to the 3D structure case. It is used to construct the genus formula in this article. The calculation has high  efficiency due to only counting the number of vertices, edges, faces and elements. In the numerical realization of  calculating the genus, it is necessary that there be no nonmanifold vertices or edges in the structure. However,  the existence of nonmanifold vertices and edges in the topology optimization process is theoretically allowed.  In the numerical implementation of a nonmanifold structure, the genus calculation formula is inaccurate (for  details, see Supplementary Material A). To accurately calculate the genus, a recovery geometric manifold method  that converts nonmanifold vertices and edges into manifold vertices and edges is proposed. The QSDV directly affects the volume fraction of the structure because it selects the variable update to meet  the genus constraint and adds the solid elements to the recovery geometric manifold. The volume fraction of the  structure cannot meet the predetermined volume constraint. A gradual removal method for structural bound- ary elements with structural genus invariance is proposed to meet the structural volume fraction constraint. The QSDV needs to accurately distinguish between solid and void elements. The discrete variable topology  optimization method is used for the implementation of maximum genus constraints. Discrete variable topology  optimization methods include topology optimization methods based on branch-and-bound algorithms36 and  topology optimization methods based on relaxation algorithms of integer programming37 and heuristic ESO38.  DVTOCRA has not only the advantages of the SIMP method but also the advantages of the BESO method39. It  is adopted as a platform for implementing topology constraints. The rest of this article is organized as follows: "Quotient set design variable method" Section illustrates the  theoretical background of the topology constraints of 3D structural topology optimization, the principle of the  QSDV, and the principle of the evolutionary removal of structural boundary elements.  "Numerical examples"  Section shows an example of topology constraints for topology optimization of a 3D cantilever beam. In "Con- clusion" Section, a conclusion of the methods proposed in this article is presented. Quotient set design variable method Topology optimization model. The topology optimization problem takes the minimal compliance of the  structure as the optimization objective, subject to constraints on the volume of the material, and is a standard  topology optimization problem. This article focuses on the problem with an additional upper-limit constraint  on the genus. Using a regular hexahedron-based mesh, the mathematical model of the topology optimization of  the QSDV is described as follows: min : ρ c(ρ) = 1 2 uT Ku N s.t. : viρi − ¯V ≤ 0 (cid:31)i=1 Ku = f ρi ∈ {0, 1}, i = 1, 2, · · · , N g ≤ G Scientific Reports | (2022) 12:16185 |  https://doi.org/10.1038/s41598-022-20248-x (1) 2 Vol:.(1234567890)www.nature.com/scientificreports/Figure 2. Structural representation of regular hexahedral elements. where N is the number of elements; ρ denotes the design variable vector; ρi is a component of ρ ; c(ρ) is the  structural compliance; u , f , and K are the global displacement, external load, and structural stiffness matrix,  respectively; vi is the volume of the i-th element; V is the prescribed volume of the material; g is the genus of the  structure; and G is the maximum genus of the structure. Calculation of the genus g.  In this article, a structure is composed of regular hexahedral elements. The  structure is actually a three-dimensional CW complex. For genera in a three-dimensional CW complex, the  formula below is derived (see Supplementary Material A for more details). The genus formula of a three-dimen- sional structure that does not contain nonmanifold vertices or edges and has no enclosed voids is (2) where ki , i = 0, 1, 2, 3 , is the number of i-dimensional cells and cn is the number of connected components of  the structure. cn can be calculated by the burning method3 from the number of connected components of the  multiconnected structure and the element composition of each connected component. k0 − k1 + k2 − k3 = cn − g Recovering geometric manifold of a structure. A structure obtained in three-dimensional topology  optimization may have nonmanifold vertices and edges. The structures of nonmanifold vertices and edges based  on regular hexahedrons are shown in Fig.  2. According to the corresponding features, a recovery geometry  manifold method that converts the nonmanifold vertices and edges into manifold vertices and edges is pro- posed. The core idea of the recovery geometry manifold method is to convert the void elements that connect the  nonmanifold vertices and edges and have higher sensitivity into solids. First, the nonmanifold vertices and edges  are identified, where a nonmanifold vertex connects only two elements and six element edges and a nonmanifold  edge connects only two elements and four element faces. Second, the nonmanifold vertices are converted into  manifold vertices or edges. Third, the nonmanifold edges are converted into manifold edges. As shown in Fig. 3, there are many strategies for the recovery geometry manifold method from a geometrical  point of view. A method based on sensitivity to first address nonmanifold vertices and then address nonmanifold edges is  chosen. The process of the method is as follows: f (VN ) = VfN + EfN b EN + EfN = VbN + EbN (cid:30) (cid:31) VfN + VbN f (cid:31) (cid:30) = VfN + EfN Scientific Reports | (2022) 12:16185 |  https://doi.org/10.1038/s41598-022-20248-x (3) (4) (5) 3 Vol.:(0123456789)www.nature.com/scientificreports/Figure 3. The strategy of recovering geometric manifold for nonmanifold structure. b EfN + EbN = VbN + EbN (6) (cid:30) where f is an operation that converts a nonmanifold vertex to a manifold vertex. VN is the nonmanifold vertex of  the structure, VfN indicates that operation f may produce a new nonmanifold vertex, EfN indicates that operation  f may produce a new nonmanifold edge, b is an operation that converts a nonmanifold edge to a manifold edge,  EN is the nonmanifold vertex of the structure, VbN indicates that operation b may produce a new nonmanifold  vertex, and EbN indicates that operation b may produce a new nonmanifold edge. (cid:31) Scientific Reports | (2022) 12:16185 |  https://doi.org/10.1038/s41598-022-20248-x 4 Vol:.(1234567890)www.nature.com/scientificreports/Figure 3. (continued) Applying Eqs. (7) and (8) Mve -1 times yields: f VfN + VbN = EfN (cid:31) b (cid:30) EfN + EbN = ∅ (7) (8) Only when the operation f or operation b processes non-manifold vertex or dges at the microstructure may  new non-manifold vertex or edges be formed. The filter method will filter the microstructure, and it is recom- mended to limit the number of microstructures by choosing a large filter radius. Thus, after a finite number of  f and b operations, a structure is converted to a manifold structure. (cid:31) (cid:30) Implementation of the QSDV. The basic principle of the QSDV is to control the change in the design var- iables to satisfy the topology constraints on topology optimization. When the genus of the structure sti obtained  in the i-th iteration meets the genus constraint and the genus of the structure sti+1 obtained in the (i + 1)-th itera- Scientific Reports | (2022) 12:16185 |  https://doi.org/10.1038/s41598-022-20248-x 5 Vol.:(0123456789)www.nature.com/scientificreports/Figure 4. The path for the variables update in the QSDV method when the maximum genus G is assumed to be  2. tion by DVTOCRA violates the constraint of the maximum genus, the elements in the structure sti are divided  into two groups by comparison with the elements in the structure sti+1 : groups of changed and unchanged ele- ments. The changed elements of the structure can be further divided into multiple connected subdomains. In these  connected subdomains, there may be spatially symmetric connected subdomains that inherit the symmetry of  the structure. This is because of the sequential updates to the design variables in the connected subdomains.  The symmetry of a structure may be destroyed to meet the genus constraint. Therefore, a quotient set of the set  of connected subdomains can be constructed by the geometric symmetry equivalence relationship. Finally, the  elements in the quotient set are sorted by the sensitivity of the optimization objective. In descending order of  total sensitivity, the elements in the quotient set that make the structure meet the genus constraint are updated. For example, the process of the QSDV method can be expressed as follows when the genus g > G: Ach = Ai ∪ Ai+1 − Ai ∩ Ai+1 fC(Ach) = AC j (cid:31) (cid:30) Cn j=1 AC j fQ (cid:31)(cid:30) Cn j=1 (cid:28) (cid:29) = AQj (cid:27) Qn j=1 (cid:26) fg AC j (cid:31)(cid:30) Qn j=1 (cid:29) = AQj (cid:27) (cid:28) Qw j=1 (cid:26) ρi+1 = ρi (9) (10) (11) (12) (13) Qw Qw (cid:29) (cid:29) AQj AQj j=1(cid:28) j=1(cid:28) (Qw ≤ Qn) ρi+1(cid:31)(cid:30) = ρD(cid:31)(cid:30) where Ai and Ai+1 are the solid element number sets of the i-th iteration and (i + 1)-th iteration, respectively, Ach  is the set of changed design variables, fC is the connectivity classification operator, Cn is the number of connectiv- ity subdomains, fQ is the symmetry classification operator, Qn is the number of elements in the quotient set, fg  is the selection operator for updatable elements in the quotient set, Qw is the number of updatable elements in  the quotient set, ρi and ρi+1 are the design variables of the i-th iteration and (i + 1)-th iteration, respectively, and  ρD represents the design variables obtained by DVTOCRA. Figure 4 shows the path for the variables update in  the QSDV method when the maximum genus G is assumed to be 2. The changed variables include those that  are transformed from void elements to solid elements and from solid elements to void elements. A connected  subdomain of changed variables is surrounded by black and white subdomains. Symmetrically changed variables  are the same colour. The connected subdomain consists of an element set that becomes solid and an element set  that becomes void, represented by two colours. (14) The iterative topology optimization procedure of the proposed QSDV method is described as follows: Scientific Reports | (2022) 12:16185 |  https://doi.org/10.1038/s41598-022-20248-x 6 Vol:.(1234567890)www.nature.com/scientificreports/Figure 5. Program flow of the QSDV method based on DVTOCRA. (a) Discretize the design domain using a finite element mesh and assign the initial parameters for the topology  optimization program. (b) Perform finite element analysis (FEA), and then calculate the elemental sensitivity according to the original  DVTOCRA. (c) Calculate the intermediate design variables by the original DVTOCRA. (d) Recover the geometric manifold of the structure. (e) Calculate the genus of the structure. (f) Determine whether the genus satisfies the constraint g ≤ G . If g ≤ G , proceed to step (g); otherwise, apply  the QSDV method, and then proceed to step (g). (g) Determine whether the volume satisfies the constraint  N i=1viρi − V ≤ 0 , proceed  to step (h); otherwise, apply the structural boundary evolution under structural genus invariance and then  proceed to step (h). N i=1viρi − V ≤ 0 . If  (cid:31) (cid:31) (h) Determine whether the process has converged. If convergence occurs, proceed to step (i); otherwise, repeat  steps (b)–(h) until convergence, and then proceed to step (i). (i) Determine whether the stopping criteria are satisfied. If so, stop optimization; otherwise, repeat steps  (b)–(i). The program flow of the QSDV method based on DVTOCRA is shown in Fig. 5. Scientific Reports | (2022) 12:16185 |  https://doi.org/10.1038/s41598-022-20248-x 7 Vol.:(0123456789)www.nature.com/scientificreports/Figure 6. Design domain and boundary conditions for topology optimization of a three-dimensional cantilever  beam. Structural boundary evolution under structural genus invariance. The basic principle of the QSDV  is to select some design variables to update from among the changed design variables according to the topology  optimization path of DVTOCRA, while other changed variables remain unchanged to meet the structural genus  constraints. The QSDV requires the initial structure to satisfy the constraint of the genus. Fortunately, because  the moving limit strategy is used to meet the volume constraint, the initial volume fraction is equal to 1. When  using the QSDV, the volume fraction violates the volume fraction limit predetermined by the moving limit  strategy. In topology optimization, the structure obtained by the QSDV may be only slightly changed from that  of the previous iteration step. Therefore, structural shape optimization is used to decrease the material volume   fraction40. The boundary element removal method under structural genus invariance is proposed to reduce the volume  fraction of the structure based on sensitivity information. The moving limit strategy is used to control the bound- ary volume fraction, which is similar to ESO/BESO methods. The algorithm removes a certain number of outer  boundary elements of the structure. This process is repeated until the volume fraction meets the constraint.  Note that the boundary elements correspond to low-sensitivity boundary elements. In this article, the boundary  element volume reduction factor is 0.99. Numerical examples A standard example of topology optimization of a three-dimensional cantilever beam demonstrates the effec- tiveness of the QSDV. The design domain is shown in Fig. 6. It is discretized into 70 × 28 × 14 regular hexahedral  elements. The lower midpoint of the right end is subject to a downwards unit load. Unless otherwise specified, the material volume fraction in this article is 0.3, the filter size is 2.1 (divided by  the element size), and the volume reduction factor is 0.98. The main reason to choose a relatively long cantilever beam is that DVTOCRA can obtain a structure with  complex topology. Figure 7a shows the structure obtained by DVTOCRA. The topological homomorphic graph  of the structure is given to determine the genus in the graph. The genus of the result g is equal to 12, the volume  fraction is 0.2999, and the objective function value is 12.954854. The recovery geometry manifold method based on the example of Fig. 7a is added to represent the history of  the genus in topology optimization and obtain the result shown in Fig. 7b. The historical variation in the genus  is shown in Fig. 7b. The peak value of the genus is 22, and the genus of the result is 16. The volume fraction of the  structure in Fig. 7b is 0.3004, and the objective function value is 12.912633, which is smaller than the value of  12.954854 in Fig. 7a. This might be the result of the stiffness matrix of the structure being improved by removing  the nonmanifold vertices in the structure. Based on the example of Fig. 7b, topology constraints are added, and the results shown in Fig. 8 are obtained.  Figure 8a–l correspond to the upper bound of the genus, with corresponding G values of 1, 3, 5, 8, 10, 12, 15, 16,  17, 18, 20 and 21. In general, the genus of the result shows an upwards trend with the increase in the G value.  The genera of the corresponding structures are 1, 3, 5, 8, 8, 7, 8, 16, 16, 9, 15 and 15. The variation in the genus  of the results also reveals that different genus constraint values G have different effects on topology optimization,  which is due to the different initial iteration steps of the QSDV. A greater impact on the results is correlated with  a smaller value of G. Figure 9 shows the change in genus in the optimization process corresponding to the example in Fig. 8. Fig- ure 9 shows that the QSDV method can effectively constrain the maximum genus in the topology optimization.  The curve of the genus parts was confirmed to be the same before the QSDV method was applied by comparing  the curves of the genera in Fig. 9. This reveals that the basic principle of the QSDV method is a modification  of the optimal path. The genus curves are the same when the constraint value of the genus is 20 and 21 because  the influence of the connected subdomain formed by the changing element on the genus can be more than one. Figure 10 shows the change in the objective function value c during the optimization process correspond- ing to the example in Fig. 8. The objective function value oscillates at the position where the QSDV method is  applied, which means that the change in the structure topology has a notable effect on the objective function  value of the structure. Scientific Reports | (2022) 12:16185 |  https://doi.org/10.1038/s41598-022-20248-x 8 Vol:.(1234567890)www.nature.com/scientificreports/Figure 7. (a) Results obtained by DVTOCRA. (b) Results obtained by DVTOCRA with a recovery geometric  manifold. In the homeomorphism graph, the green dots represent displacement constraints, and the red arrow  represents the load. Conclusion This article proposes the QSDV based on DVTOCRA for 3D structural topology optimization to meet the genus  constraint. The essence of the QSDV is to adjust the optimized result in the topology optimization iterations  to meet the constraint on the maximum genus. The numerical examples reveal that the QSDV can effectively  constrain the maximum genus of an optimized structure. When the value of the upper limit G of the genus  is too small, the QSDV method may converge to a local minimum solution. In such cases, one can adjust the  parameters, such as the size of the filter radius, to obtain a better-performing solution. In topology optimization, the 3D Euler-Poincaré characteristic number is used to construct the calculation  genus formula. To calculate the genus of a structure correctly, a recovery structure geometry manifold is proposed  based on the sensitivity of the optimal object. Using powerful tools in geometry, the combinational operations  used to maintain the manifold of the surface of the optimized structure are beneficial for structural topology  optimization. The implementation of the above steps is of significance for the postprocessing of geometry and  subsequent computer-aided numerical analysis based on the optimized structure. From the numerical examples, we speculate that removing nonmanifold vertices during the topology opti- mization process has a positive effect on the results of topology optimization. Therefore, the geometric manifold  strategy has potential for further research. Scientific Reports | (2022) 12:16185 |  https://doi.org/10.1038/s41598-022-20248-x 9 Vol.:(0123456789)www.nature.com/scientificreports/(d) G = 8, g = 8, V = 0.2980 Figure 8. Topology constraint results of 3D cantilever beam topology optimization. G is the upper limit of the  genus, and g is the actual genus of the final structure. In the homeomorphism graph, the green dots represent  displacement constraints, and the red arrow represents a load. Scientific Reports | (2022) 12:16185 |  https://doi.org/10.1038/s41598-022-20248-x 10 Vol:.(1234567890)www.nature.com/scientificreports/Figure 9. Change in the genus of the structure during the optimization process of the example in Fig. 8. The  line marked “g peak” gives the maximum genus of the structure appearing in the optimization process. The line  marked “it.” gives the maximum iteration step. Scientific Reports | (2022) 12:16185 |  https://doi.org/10.1038/s41598-022-20248-x 11 Vol.:(0123456789)www.nature.com/scientificreports/Figure 10. Change in the objective function value of the structure during the optimization process for the  example in Fig. 8. The line marked “Obj.” gives the final value of the objective function. The line marked “it.”  gives the maximum iteration step. Scientific Reports | (2022) 12:16185 |  https://doi.org/10.1038/s41598-022-20248-x 12 Vol:.(1234567890)www.nature.com/scientificreports/Data availability The data that support the findings of this study are available from the corresponding author upon reasonable  request. Received: 14 March 2022; Accepted: 12 September 2022 References  1. Petersson, J. & Sigmund, O. Slope constrained topology optimization. Int J. Numer. Methods Eng. 41(8), 1417–1434. https:// doi.  org/ 10. 1002/ (SICI) 1097- 0207(19980 430) 41:8% 3c141 7:: AID- NME344% 3e3.0. CO;2-N (1998).  2. Zhao, Z., Zhou, S., Cai, K. & Xie, Y. M. A direct approach to controlling the topology in structural optimization. Comput. Struct.  227, 106141. https:// doi. org/ 10. 1016/j. comps truc. 2019. 106141 (2020).  3. Han, H., Guo, Y., Chen, S. & Liu, Z. Topological constraints in 2D structural topology optimization. Struct. Multidiscipl. Optim.  63, 39–58. https:// doi. org/ 10. 1007/ s00158- 020- 02771-5 (2020).  4. Bujny, M., Aulig, N., Olhofer, M. & Duddeck, F. Evolutionary level set method for crashworthiness topology optimization. Conf.  ECCOMAS Congr. https:// doi. org/ 10. 7712/ 100016. 1814. 11054 (2016).  5. Sigmund, O. & Petersson, J. Numerical instabilities in topology optimization: A survey on procedures dealingwith checkerboards,  meshdependencies and local minima. Struct. Optim. 16, 68–75. https:// doi. org/ 10. 1007/ BF012 14002 (1998).  6. Bourdin, B. Filters in topology optimization. Int. J. Numer. Methods Eng. 50(9), 2143–2158. https:// doi. org/ 10. 1002/ nme. 116 (2001).  7. Pedersen, C. G., Lund, J. J., Damkilde, L. & Kristensen, A. S. A. Topology optimization—Improved checker-board filtering with  sharp contours. Proc. 19th Nordic Seminar Comput. Mech. 2006, 182–185 (2006).  8. Qie, L., Jing, S. & Lian, R. Heaviside-based morphological filters for topology optimization. IOP Conf. Series Mater. Sci. Eng. 472,  012034 (2019).  9. Buhl, T., Pedersen, C. B. W. & Sigmund, O. Stiffness design of geometrically nonlinear structures using topology optimization.  Struct. Multidiscipl. Optim. 19, 93–104. https:// doi. org/ 10. 1007/ s0015 80050 089 (2000).  10. Petersson, J. Some convergence results in perimeter-controlled topology optimization. Comput. Methods Appl. Mech. Eng. 171(1–2),  123–140. https:// doi. org/ 10. 1016/ S0045- 7825(98) 00248-5 (1999).  11. Guest, J. K., Prevost, J. H. & Belytschko, T. Achieving minimum length scale in topology optimization using nodal design variables  and projection functions. Int. J. Numer. Methods Eng. 61, 238–254. https:// doi. org/ 10. 1002/ nme. 1064 (2004).  12. Wang, M. Y. & Wang, S. Bilateral filtering for structural topology optimization. Int. J. Numer. Methods Eng. 63(13), 1911–1938.  https:// doi. org/ 10. 1002/ nme. 1347 (2005).  13. Munro, D. & Groenwold, A. Local stress-constrained and slope-constrained SAND topology optimization. Int. J. Numer. Methods  Eng. 110(5), 420–439. https:// doi. org/ 10. 1002/ nme. 5360 (2016).  14. Fernández, E., Collet, M., Alarcón, P., Bauduin, S. & Duysinx, P. An aggregation strategy of maximum size constraints in density- based topology optimization. Struct. Multidiscipl. Optim. 60, 2113–2130. https:// doi. org/ 10. 1007/ s00158- 019- 02313-8 (2019).  15. Fernández, E. et al. Imposing minimum and maximum member size, minimum cavity size, and minimum separation distance  between solid members in topology optimization. Comput. Methods Appl. Mech. Eng. 368, 113157. https:// doi. org/ 10. 1016/j. cma.  2020. 113157 (2020).  16. Zhang, W., Zhou, J., Zhu, Y. & Guo, X. Structural complexity control in topology optimization via Moving Morphable Component  (MMC) approach. Struct. Multidiscipl. Optim. 56, 535–552. https:// doi. org/ 10. 1007/ s00158- 017- 1736-y (2017).  17. Kim, H., Querin, O. M., Steven, G. P. & Xie, Y. M. A method for varying the number of cavities in an optimized topology using  Evolutionary Structural Optimization. Struct. Multidiscip. Optim. 19(13), 140–147. https:// doi. org/ 10. 1007/ s0015 80050 094 (2014).  18. Li, Q., Chen, W., Liu, S. & Fan, H. Topology optimization design of cast parts based on virtual temperature method. CAD Comput.  Aided Des. 94, 28–40. https:// doi. org/ 10. 1016/j. cad. 2017. 08. 002 (2018).  19. Liu, S., Li, Q., Chen, W., Tong, L. & Cheng, G. An identification method for internal enclosed-holes restriction in manufacturability  design for additive manufacturing structures. Front. Mech. Eng. China 10, 126–137. https:// doi. org/ 10. 1007/ s11465- 015- 0340-3  (2015).  20. Liang, Y., Yan, X. & Cheng, G. Explicit control of 2D and 3D structural complexity by discrete variable topology optimization  method. Comput. Methods Appl. Mech. Eng. https:// doi. org/ 10. 1016/j. cma. 2021. 114302 (2021).  21. Zhou, H. & Kolavennu, S. T. Discrete topology optimization of structures without uncertainty. Proc. ASME 2013 Int. Mech. Eng.  Congr. Expos. https:// doi. org/ 10. 1115/ IMECE 2013- 62824 (2013).  22. Chen, L. & Rong, Y. Digital topological method for computing genus and the Betti numbers. Topol. Appl. 157(12), 1931–1936.  https:// doi. org/ 10. 1016/j. topol. 2010. 04. 006 (2010).  23. Chen, L. Discrete Surfaces and Manifolds (Scientific Practical Computing, 2004).  24. Liang, Y. & Cheng, G. Further elaborations on topology optimization via sequential integer programming and Canonical relaxa- tion algorithm and 128-line MATLAB code. Struct. Multidiscipl. Optim. 61, 411–431. https:// doi. org/ 10. 1007/ s00158- 019- 02396-3  (2020).  25. do Carmo, M. Riemannian geometry (Birkhäuser, 1992).  26. Chen, B. & Chen, G. Gauss-Bonnet formula, finiteness condition, and characterizations of graphs embedded in surfaces. Graphs  Comb. 24, 159–183. https:// doi. org/ 10. 1007/ s00373- 008- 0782-z (2008).  27. Chen, B. The Gauss-Bonnet formula of polytopal manifolds and the characterization of embedded graphs with nonnegative  curvature. Proc. Amer. Math. Soc. 137, 1601–1611. https:// doi. org/ 10. 1090/ S0002- 9939- 08- 09739-6 (2009).  28. Dyer, C. R. Computing the Euler number of an image from its quadtree. Comput. Graph. Image Process. 13, 270–276. https:// doi.  org/ 10. 1016/ 0146- 664X(80) 90050-7 (1980).  29. Lin, X., Xiang, S. & Gu, Y. A new approach to compute the Euler Number of 3D image. 3rd IEEE Conf. Ind. Electron. Appl. ICIEA  https:// doi. org/ 10. 1109/ ICIEA. 2008. 45827 77 (2008).  30. Delfinado, C. J. A. & Edelsbrunner, H. An incremental algorithm for Betti numbers of simplicial complexes on the 3-sphere.  Comput. Aided Geometric Design 12(7), 771–784. https:// doi. org/ 10. 1016/ 0167- 8396(95) 00016-Y (1995).  31. Basu, S. & Kettner, M. Computing the Betti numbers of arrangements in practice. In Computer Algebra in Scientific Computing  Vol. 3718 (eds Ganzha, V. G. et al.) (Springer, 2005). https:// doi. org/ 10. 1007/ 11555 964_2.  32. Gonzalez-Lorenzo, A., Juda, M., Bac, A., Mari, J. L. & Real, P. Fast, simple and separable computation of Betti numbers on 3D  cubical complexes. In Computational Topology in Image Context Vol. 9667 (eds Bac, A. & Mari, J. L.) (Springer, 2016). https:// doi.  org/ 10. 1007/ 978-3- 319- 39441-1_ 12.  33. Griffiths, H. B. The fundamental group of a surface, and a theorem of Schreier. Acta Math. 110, 1–17. https:// doi. org/ 10. 1007/  BF023 91853 (1963).  34. Damiand, G., Peltier, S. & Fuchs, L. Computing homology generators for volumes using minimal generalized maps. Int. Workshop  Comb. Image Anal. 4958, 60–74. https:// doi. org/ 10. 1007/ 978-3- 540- 78275-9_6 (2008).  35. Gu, D. X. & Yau, S. T. Computational conformal geometry. HIGHER EDUCATION PRESS. International Press, Somerville, Mas- sachusetts, U.S.A.; Higher Education Press, Beijing, China (2008). Scientific Reports | (2022) 12:16185 |  https://doi.org/10.1038/s41598-022-20248-x 13 Vol.:(0123456789)www.nature.com/scientificreports/ 36. Sivapuram, R. & Picelli, R. Topology optimization of binary structures using Integer Linear Programming. Finite Elements Anal.  Design 139, 49–61. https:// doi. org/ 10. 1016/j. finel. 2017. 10. 006 (2018).  37. Beckers, M. Topology optimization using a dual method with discrete variables. Struct. Optim. 17, 14–24. https:// doi. org/ 10. 1007/  BF011 97709 (1999).  38. Xie, Y. M. & Steven, G. P. A simple evolutionary procedure for structural optimization. Comput. Struct. 49(5), 885–896. https://  doi. org/ 10. 1016/ 0045- 7949(93) 90035-C (1993).  39. Huang, X. & Xie, Y. M. Bi-directional evolutionary topology optimization of continuum structures with one or multiple materials.  Comput. Mech. 43, 393–401. https:// doi. org/ 10. 1007/ s00466- 008- 0312-0 (2009).  40. Allaire, G., Dapogny, C. & Jouve, F. Shape and topology optimization. In Handbook of Numerical Analysis Vol. 22 1–132 (Elsevier,  2021). https:// doi. org/ 10. 1016/ bs. hna. 2020. 10. 004. Author contributions H.H. wrote the main manuscript text and T.Z. prepared some figures. All authors reviewed the manuscript. Z.L.  provides guidance and advice throughout the process. Funding This work was supported by the National Science Foundation of China #1 under Grant no. 51675506 and the  National Science and Technology Major Project #2 under Grant 2017ZX10304403. Competing interests  The authors declare no competing interests. Additional information Supplementary Information The online version contains supplementary material available at https:// doi. org/  10. 1038/ s41598- 022- 20248-x. Correspondence and requests for materials should be addressed to Z.L. Reprints and permissions information is available at www.nature.com/reprints. Publisher’s note Springer Nature remains neutral with regard to jurisdictional claims in published maps and  institutional affiliations. Open Access This article is licensed under a Creative Commons Attribution 4.0 International  License, which permits use, sharing, adaptation, distribution and reproduction in any medium or  format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the  Creative Commons licence, and indicate if changes were made. The images or other third party material in this  article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the  material. If material is not included in the article’s Creative Commons licence and your intended use is not  permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from  the copyright holder. To view a copy of this licence, visit http:// creat iveco mmons. org/ licen ses/ by/4. 0/. © The Author(s) 2022 Scientific Reports | (2022) 12:16185 |  https://doi.org/10.1038/s41598-022-20248-x 14 Vol:.(1234567890)www.nature.com/scientificreports/